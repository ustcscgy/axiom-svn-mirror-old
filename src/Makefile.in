

SUBDIRS = @SRC_SUBDIRS@

pamphlets = Makefile.pamphlet

subdir = src/

.PHONY: all all-ax all-src all-clef all-sman 

all: all-ax

all-ax all-src: stamp
	@echo finished $(builddir)

stamp: @axiom_src_all@ all-book 
	-rm -f stamp
	$(STAMP) stamp

all-clef: all-lib
	@$(mkinstalldirs) $(axiom_target_bindir)
	cd clef && ${ENV} ${MAKE}
all-sman: all-lib
	$(mkinstalldirs) $(axiom_target_bindir)
	$(mkinstalldirs) $(axiom_target_libdir)
	cd sman && ${ENV} ${MAKE}
all-hyper: all-lib
	$(mkinstalldirs) $(axiom_target_bindir)
	$(mkinstalldirs) $(axiom_target_datadir)
	cd hyper && ${ENV} ${MAKE}
all-share:
	$(mkinstalldirs) $(axiom_target_libdir)
	cd share && ${ENV} ${MAKE}
all-doc:
	@ $(mkinstalldirs) ${INT}/doc
	cd doc && ${ENV} ${MAKE}
all-book:
	cd booklets && ${ENV} ${MAKE}
all-lib:
	@cd lib && ${ENV} ${MAKE}
all-boot: $(GCL)
	@cd boot && ${ENV} ${MAKE}
all-interpsys: all-boot
	@echo 25 making ${INT}/interp
	@$(mkinstalldirs) ${INT}/interp
	@$(mkinstalldirs) ${INT}/algebra
	@$(mkinstalldirs) ${OBJ}/${SYS}/interp
	cd interp && ${ENV} ${MAKE} all-interpsys

all-axiomsys: all-asq
	cd interp && $(ENV) $(MAKE) all-axiomsys
all-algebra: all-interpsys all-share
	@ $(mkinstalldirs) ${INT}/algebra
	@ $(mkinstalldirs) ${INT}/input
	@ $(mkinstalldirs) ${OBJ}/${SYS}/algebra
	$(TANGLE) -t8 -RfindAlgebraFiles $(srcdir)/algebra/Makefile.pamphlet \
                  > $(INT)/algebra/findAlgebraFiles && \
	echo 30b running ${INT}/algebra/findAlgebraFiles && \
	(cd $(srcdir)/algebra && . $(INT)/algebra/findAlgebraFiles) \
          > $(builddir)/algebra/more-rules.mk
	cd algebra && ${ENV} ${MAKE}
all-input: all-axiomsys all-clef
	@ $(mkinstalldirs) ${INT}/input
	cd input && ${ENV} ${MAKE}
all-asq: all-algebra
	cd etc && ${ENV} ${MAKE}
all-graph: all-lib
	@ $(mkinstalldirs) ${INT}/graph/parabola
	@ $(mkinstalldirs) ${OBJ}/${SYS}/graph
	cd graph && ${ENV} ${MAKE}

mostlyclean-local:
	-rm -f stamp

clean-local: mostlyclean-local

distclean-local: clean-local

