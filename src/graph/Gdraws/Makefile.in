IN=	$(axiom_src_srcdir)/graph/Gdraws
MIDINT=	${INT}/graph/Gdraws
MIDOBJ=	${OBJ}/${SYS}/graph/Gdraws
OUT=	${MNT}/${SYS}/lib
PS=	${MNT}/${SYS}/lib/graph
DOC=    ${MNT}/${SYS}/doc/src/graph

# local include files shared by graphics
LINC=	$(axiom_src_srcdir)/graph/include

# global include files shared by everyone
GINC=	$(axiom_src_srcdir)/include

# include files in Hyperdoc
HINC=	$(axiom_src_srcdir)/hyper

# bitmaps for cursors
BIT=	$(axiom_src_srcdir)/graph/include/bitmaps

# a .h file stuck in a really wierd place
DOTH=	$(axiom_src_srcdir)/graph/viewman

# a .c file in the library subdirectory
DOTC=	$(axiom_src_srcdir)/lib


DOCFILES= ${DOC}/Gfun.c.dvi ${DOC}/psFiles.dvi

CFLAGS	    = ${CCF} -I${LINC} -I${GINC} -I$(srcdir) -I${HINC}

HEADERS = ${IN}/Gdraws0.h ${LINC}/G.h     ${LINC}/Gfun.H1    \
          ${GINC}/hash.h  ${GINC}/hash.H1 ${GINC}/useproto.h

PSFiles= ${PS}/colorpoly.ps ${PS}/colorwol.ps  ${PS}/draw.ps      \
         ${PS}/drawIstr.ps  ${PS}/drawarc.ps   ${PS}/drawcolor.ps \
         ${PS}/drawline.ps  ${PS}/drawlines.ps ${PS}/drawpoint.ps \
         ${PS}/drawrect.ps  ${PS}/drawstr.ps   ${PS}/drwfilled.ps \
         ${PS}/end.ps       ${PS}/fillarc.ps   ${PS}/fillpoly.ps  \
         ${PS}/fillwol.ps   ${PS}/header.ps    ${PS}/setup.ps

all: ${MIDOBJ}/Gfun.o ${PSFiles} ${DOCFILES}
	@ echo 21 finished making $(axiom_src_srcdir)/Gdraws

${MIDINT}/Gfun.c: $(srcdir)/Gfun.c.pamphlet
	$(axiom_build_document) --tangle --output=$@ $<

${MIDOBJ}/Gfun.o: ${HEADERS} ${MIDINT}/Gfun.c 
	@ echo 2 making ${MIDOBJ}/Gfun.o from ${MIDINT}/Gfun.c
	@ ${CC} -c ${CFLAGS} ${MIDINT}/Gfun.c -o $@

${DOC}/Gfun.c.dvi: $(axiom_build_texdir)/axiom.sty

${DOC}/Gfun.c.dvi: $(srcdir)/Gfun.c.pamphlet
	$(axiom_build_document) --weave --latex $<
	$(INSTALL_DATA) Gfun.c.dvi $@


${PS}/colorpoly.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=colorpoly --output=$@ $<

${PS}/colorwol.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=colorwol --output=$@ $<

${PS}/draw.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=draw --output=$@ $<

${PS}/drawIstr.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=drawIstr --output=$@ $<

${PS}/drawarc.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=drawarc --output=$@ $<

${PS}/drawcolor.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=drawcolor --output=$@ $<

${PS}/drawline.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=drawline --output=$@ $<

${PS}/drawlines.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=drawlines --output=$@ $<

${PS}/drawpoint.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=drawpoint --output=$@ $<

${PS}/drawrect.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=drawrect --output=$@ $<

${PS}/drawstr.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=drawstr --output=$@ $<

${PS}/drwfilled.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=drwfilled --output=$@ $<

${PS}/end.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=end --output=$@ $<

${PS}/fillarc.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=fillarc --output=$@ $<

${PS}/fillpoly.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=fillpoly --output=$@ $<

${PS}/fillwol.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=fillwol --output=$@ $<

${PS}/header.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=header --output=$@ $<

${PS}/setup.ps: $(srcdir)/psFiles.pamphlet
	$(axiom_build_document) --tangle=setup --output=$@ $<


${DOC}/psFiles.dvi: $(srcdir)/psFiles.pamphlet $(axiom_build_texdir)/axiom.sty
	@echo 3 making ${DOC}/psFiles.dvi from ${IN}/psFiles.pamphlet 
	@(cd ${DOC} ; \
	cp ${IN}/psFiles.pamphlet ${DOC} ; \
	${DOCUMENT} ${NOISE} psFiles ; \
	rm -f ${DOC}/psFiles.pamphlet ; \
	rm -f ${DOC}/psFiles.tex ; \
	rm -f ${DOC}/psFiles )


clean: 
	@ echo 22 cleaning $(builddir)

document: 
	@ echo 23 documenting $(builddir)

