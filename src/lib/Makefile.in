IN=${SRC}/lib
MID=${INT}/lib
OUT=${OBJ}/${SYS}/lib
DOCINT=${INT}/doc/src/lib
DOCMNT=${MNT}/${SYS}/doc/src/lib
INC= $(axiom_src_srcdir)/include

AR=	${OUT}/bsdsignal.o  ${OUT}/cursor.o ${OUT}/edin.o     \
        ${OUT}/fnct_key.o   ${OUT}/halloc.o ${OUT}/openpty.o  \
        ${OUT}/pixmap.o     ${OUT}/prt.o    ${OUT}/sockio-c.o \
        ${OUT}/spadcolors.o ${OUT}/util.o   ${OUT}/wct.o      \
        ${OUT}/XDither.o    ${OUT}/XShade.o ${OUT}/XSpadFill.o 

OTHER=	${OUT}/cfuns-c.o ${OUT}/hash.o

DOCFILES=\
 ${DOCMNT}/bsdsignal.c.dvi  ${DOCMNT}/cfuns-c.c.dvi  ${DOCMNT}/cursor.c.dvi \
 ${DOCMNT}/edin.c.dvi       ${DOCMNT}/fnct_key.c.dvi ${DOCMNT}/halloc.c.dvi \
 ${DOCMNT}/hash.c.dvi       ${DOCMNT}/openpty.c.dvi  ${DOCMNT}/pixmap.c.dvi \
 ${DOCMNT}/prt.c.dvi        ${DOCMNT}/sockio-c.c.dvi ${DOCMNT}/Makefile.dvi \
 ${DOCMNT}/spadcolors.c.dvi ${DOCMNT}/util.c.dvi     ${DOCMNT}/wct.c.dvi    \
 ${DOCMNT}/XDither.c.dvi    ${DOCMNT}/XShade.c.dvi   ${DOCMNT}/XSpadFill.c.dvi 


all: ${OUT}/libspad.a ${OTHER} ${DOCFILES}
	@echo 72 finished making $(builddir)

${OUT}/libspad.a: ${AR} 
	@echo 73 making ${OUT}/libspad.a
	@(cd ${OUT} ; \
	ar ru ${OUT}/libspad.a ${AR} ; \
	${RANLIB} ${OBJ}/${SYS}/lib/libspad.a )

.PRECIOUS: $(DOCMNT)/%.dvi
.PRECIOUS: $(builddir)/%.dvi
.PRECIOUS: $(builddir)/%.tex

$(DOCMNT)/%.dvi: $(builddir)/%.dvi
	$(INSTALL) $< $@

$(builddir)/%.dvi: $(axiom_build_texdir)/axiom.sty

$(builddir)/%.dvi: $(builddir)/%.tex
	$(axiom_build_document) --latex $<

$(builddir)/%.tex: $(srcdir)/%.pamphlet
	$(axiom_build_document) --weave $<
.PRECIOUS: $(builddir)/%.c

$(builddir)/%.c: $(srcdir)/%.c.pamphlet
	$(axiom_build_document) --tangle $<
.PRECIOUS: $(OUT)/%.o

$(OUT)/%.o: $(builddir)/%.c
	$(CC) $(CCF) -c -I$(INC) $< -o $@

document: ${DOCFILES}
	@echo 69 documenting ${IN}

clean:
	@echo 70 cleaning $(builddir)
	@rm -rf $(AR) $(OTHER)
	rm $(builddir)/*.log $(builddir)/*.aux $(builddir)/*.toc

distclean: clean
	rm -f $(builddir)/Makefile
	rm -f $(builddir)/*.tex
	rm -f $(builddir)/*.dvi
	rm -rf $(DOCMNT)
	rm -rf $(OUT)

