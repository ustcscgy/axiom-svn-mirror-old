INC= $(axiom_src_srcdir)/include

libspad_a_sources = bsdsignal.c cursor.c edin.c fnct_key.c edin.c \
	halloc.c hash.c openpty.c pixmap.c prt.c sockio-c.c spadcolors.c \
	util.c wct.c XDither.c XShade.c XSpadFill.c

libspad_a_SOURCES = $(addsuffix .pamphlet,$(libspad_a_sources))

other_sources = cfuns-c.c

other_SOURCES = $(addsuffix .pamphlet,$(other_sources))

unused_sources = emupty.c

libspad_a_objects = $(libspad_a_sources:.c=.o)

other_objects = $(other_sources:.c=.o)

pamphlets = Makefile.pamphlet $(libspad_a_SOURCES) $(other_SOURCES)


subdir = src/lib/

all: $(builddir)/libspad.a $(other_objects)

$(builddir)/libspad.a: $(libspad_a_objects)
	$(AR) ru $(builddir)/libspad.a $(libspad_a_objects)
	$(RANLIB) $(builddir)/libspad.a

.PRECIOUS: $(builddir)/%.c

$(builddir)/%.c: $(srcdir)/%.c.pamphlet
	$(axiom_build_document) --tangle --output=$@ $<

.PRECIOUS: $(builddir)/%.o

$(builddir)/%.o: $(builddir)/%.c
	$(CC) $(CCF) -c -I$(INC) $< -o $@

clean-local:
	-rm -f $(libspad_a_objects) $(other_objects)
	-rm -f $(builddir)/libspad.a
