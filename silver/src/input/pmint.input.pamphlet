\documentclass{article}
\usepackage{axiom}
\begin{document}
\title{\$SPAD/src/input pmint.input}
\author{Manuel Bronstein and Timothy Daly}
\maketitle
\begin{abstract}
\end{abstract}
\eject
\tableofcontents
\eject
\section{License}
<<license>>=
--Copyright The Numerical Algorithms Group Limited 1991.
@
<<*>>=
)spool pmint.output
)set message test on
)set message auto off
)clear all
 
@
\section{Rational Functions}
<<*>>=
--S 1 of 28
f:=(x^7-24*x^4-4*x^2+8*x-8)/(x^8+6*x^6+12*x^4+8*x^2)
--R 
--R
--R         7      4     2
--R        x  - 24x  - 4x  + 8x - 8
--R   (1)  ------------------------
--R           8     6      4     2
--R          x  + 6x  + 12x  + 8x
--R                                            Type: Fraction Polynomial Integer
--E 1

--S 2 of 28
g:=integrate(f,x)
--R 
--R
--R          5     3                 3     2
--R        (x  + 4x  + 4x)log(x) + 3x  + 8x  + 6x + 4
--R   (2)  ------------------------------------------
--R                        5     3
--R                       x  + 4x  + 4x
--R                                          Type: Union(Expression Integer,...)
--E 2

--S 3 of 28
differentiate(g,x)
--R 
--R
--R         7      4     2
--R        x  - 24x  - 4x  + 8x - 8
--R   (3)  ------------------------
--R           8     6      4     2
--R          x  + 6x  + 12x  + 8x
--R                                                     Type: Expression Integer
--E 3

)clear all

@
\section{Trigonometric Functions}
<<*>>=
--S 4 of 28
f:=(x-tan(x))/tan(x)^2 + tan(x)
--R 
--R
--R              3
--R        tan(x)  - tan(x) + x
--R   (1)  --------------------
--R                     2
--R               tan(x)
--R                                                     Type: Expression Integer
--E 4

--S 5 of 28
g:=integrate(f,x)
--R 
--R
--R                        2         2
--R        tan(x)log(tan(x)  + 1) - x tan(x) - 2x
--R   (2)  --------------------------------------
--R                        2tan(x)
--R                                          Type: Union(Expression Integer,...)
--E 5

--S 6 of 28
differentiate(g,x)
--R 
--R
--R              3
--R        tan(x)  - tan(x) + x
--R   (3)  --------------------
--R                     2
--R               tan(x)
--R                                                     Type: Expression Integer
--E 6

)clear all

@
\section{Log-Exp Functions}

--S 7 of 28
f:=(1+x+x*exp(x))*(x+log(x)+exp(x)-1)/(x+log(x)+exp(x))^2/x
--R 
--R
--R              x                       x 2     2       x    2
--R         (x %e  + x + 1)log(x) + x (%e )  + (x  + 1)%e  + x  - 1
--R   (1)  ---------------------------------------------------------
--R                2         x     2               x 2     2  x    3
--R        x log(x)  + (2x %e  + 2x )log(x) + x (%e )  + 2x %e  + x
--R                                                     Type: Expression Integer
--E 7

--S 8 of 28
g:=integrate(f,x)
--R 
--R
--R                    x                    x
--R        (log(x) + %e  + x)log(log(x) + %e  + x) + 1
--R   (2)  -------------------------------------------
--R                                 x
--R                      log(x) + %e  + x
--R                                          Type: Union(Expression Integer,...)
--E 8

--S 9 of 28
differentiate(g,x)
--R 
--R
--R              x                       x 2     2       x    2
--R         (x %e  + x + 1)log(x) + x (%e )  + (x  + 1)%e  + x  - 1
--R   (3)  ---------------------------------------------------------
--R                2         x     2               x 2     2  x    3
--R        x log(x)  + (2x %e  + 2x )log(x) + x (%e )  + 2x %e  + x
--R                                                     Type: Expression Integer
--E 9

)clear all

@
\section{Liouvillian special functions}
<<*>>=
--S 10 of 28
f:=exp(-x^2)+erf(x)/(erf(x)^3-erf(x)^2-erf(x)+1)
--R 
--R
--R                                             2
--R               3         2                - x
--R        (erf(x)  - erf(x)  - erf(x) + 1)%e     + erf(x)
--R   (1)  -----------------------------------------------
--R                       3         2
--R                 erf(x)  - erf(x)  - erf(x) + 1
--R                                                     Type: Expression Integer
--E 10

--S 11 of 28
f:=(exp(-x^2)+erf(x))/(erf(x)^3-erf(x)^2-erf(x)+1)
--R 
--R
--R                     2
--R                  - x
--R                %e     + erf(x)
--R   (2)  ------------------------------
--R              3         2
--R        erf(x)  - erf(x)  - erf(x) + 1
--R                                                     Type: Expression Integer
--E 11

--S 12 of 28 used to work!
integrate(f,x)
--R 
--R
--R                           2
--R           x           - %G
--R         ++          %e      + erf(%G)
--R   (3)   |   --------------------------------- d%G
--R        ++          3          2
--R             erf(%G)  - erf(%G)  - erf(%G) + 1
--R                                          Type: Union(Expression Integer,...)
--E 12
-- should be:
--    1   sqrt(%pi)     1                           1
-- -  - ------------  - - sqrt(%pi) log(erf(x)+1) + - sqrt(%pi) log(erf(x)-1)
--    4  erf(x) - 1     8                           8

)clear all
 
@
\section{Airy Functions}
<<*>>=
-- Axiom does not have a 2 argument form of the airyAi function
--S 13 of 28 will certainly fail
f:=(x-airyAi(x)*airyAi(1,x))/(x^2-airyAi(x)^2)
--R
--E 13

--S 14 of 28 will certainly fail
integrate(f,x)
--R
--R  1                    1
--R  - log(x+airyAi(x)) + - log(x-airyAi(x))
--R  2                    2
--E 14

--S 15 of 28
f:=x^2*airyAi(x)
--R 
--R
--R         2
--R   (1)  x airyAi(x)
--R                                                     Type: Expression Integer
--E 15

--S 16 of 28 used to work
g:=integrate(f,x)
--R 
--R
--R           x
--R         ++    2
--R   (2)   |   %G airyAi(%G)d%G
--R        ++
--R                                          Type: Union(Expression Integer,...)
--E 16
-- should be:
--  -airyAi(x) + airyAi(1,x) x

)clear all

@
\section{Bessel functions}
--S 17 of 28
f:=besselJ(y+1,x)/besselJ(y,x)
--R 
--R
--R        besselJ(y + 1,x)
--R   (1)  ----------------
--R          besselJ(y,x)
--R                                                     Type: Expression Integer
--E 17

--S 18 of 28 used to work
g:=integrate(f,x)
--R 
--R
--R           x
--R         ++  besselJ(y + 1,%G)
--R   (2)   |   ----------------- d%G
--R        ++     besselJ(y,%G)
--R                                          Type: Union(Expression Integer,...)
--E 18
-- should be:
--  y log(x) - log(besselJ(y,x))

-- Axiom does not have Maple's normal function
--S 19 of 28 used to work
f:=normal(y*besselJ(y,x)/x = besselJ(y+1,x))
--R
--E 19
-- should be:
--   besselJ(y+1,x) x - y besselJ(y,x)
-- - ---------------------------------
--                  x

)clear all

@
\section{Whittaker functions}
--S 20 of 28 used to work
f:=WhittakerW(u+1,n,x)/(WhittakerW(u,n,x)*x)
--R
--E 20
-- Axiom does not implement WhittakerW
-- should be:
--  Whittaker(u+1,n,x)
--  ------------------
--  Whittaker(u,n,x) x

--S 21 of 28 used to work
integrate(f,x)
--R
--E 21
-- should be:
--  x
--  -  - u log(x) - log(WhattakerW(u,n,x))
--  2

)clear all

@
\section{The Lambert W function} 
<<*>>=
-- Axiom does not implement LambertW
--S 22 of 28 used to work
f:=LambertW(x)
--R
--E 22

--S 23 of 28 used to work
g:=integrate(f,x)
--R
--E 23
-- should be:
--    2             2  2                2
--   x + LambertW(x)  x  - LambertW(x) x
--   ------------------------------------
--          x LambertW(x)

--S 24 of 28 used to work
integrate(sin(LambertW(x)),x)
--R
--E 24
--should be:
-- +-                                                  -+
-- |                                     2              |
-- |                    +-             -+               |
-- |  1                 | 1             |  2            |
-- |  - LambertW(x) tan | - LambertW(x) | x   +         |
-- |  2                 | 2             |               |
-- |                    +-             -+               |
-- |                                                    |
-- |                  +-             -+                 |
-- |                  | 1             |  2              |
-- |  LambertW(x) tan | - LambertW(x) | x  +            |
-- |                  | 2             |                 |
-- |                  +-             -+                 |
-- |                                                    |
-- |      +-             -+                             |
-- |      | 1             |  2      1              2    |
-- |  tan | - LambertW(x) | x  -    - LambertW(x) x     |
-- |      | 2             |         2                   |
-- |      +-             -+                             |
-- +-                                                  -+
-- ------------------------------------------------------
--                  +-                         2 -+
--                  |         +-             -+   |
--                  |         | 1             |   |
--    x LambertW(x) | 1 + tan | - LambertW(x) |   |
--                  |         | 2             |   |
--                  |         +-             -+   |
--                  +-                           -+

--S 25 of 28 used to work
f:=((x^2+2)*LambertW(x^2)^2+x^2*(2*LambertW(x^2)+1))/(x*(1+LambertW(x^2)^3))
--R
--E 25
--should be:
--                       2
--    2                2      2              2
--  (x  + 2) LambertW(x )  + x  (2 LambertW(x ) + 1)
--  ------------------------------------------------
--                               3
--                            2  
--           x (1 + LambertW(x ))

--S 26 of 28 used to work
integrate(f,x)
--R
--E 26
--should be:
--                 2                    4
--1  4           2     4          2    x              2   2    2           2
--- x  LambertW(x ) + x LambertW(x ) + -- + LambertW(x ) x  + x  LambertW(x )
--2                                    2
-----------------------------------------------------------------------------
--                                              2
--              2          2                 2
--             x LambertW(x ) (1 + LambertW(x ))
--
--  +
--                     2
--   log(1 + LambertW(x ))

--S 27 of 28 used to work
f:=(2*LambertW(x^2)*cos(LambertW(x^2))*(a*x+LambertW(x^2))+a*x*(1+LambertW(x^2)) + 2*LambertW(x^2))/((1+LambertW(x^2))*(a*x+LambertW(x^2))*x)
--R
--E 27
--+-                                                       -+
--|                                                         |
--|             2                2                    2     |
--| 2 LambertW(x ) cos(LambertW(x )) (a x + LambertW(x )) + |
--|                                                         |
--|                   2                 2                   |
--| a x (1 + LambertW(x )) + 2 LambertW(x )                 |
--|                                                         |
--+-                                                       -+
-------------------------------------------------------------
--                2                 2
-- (1 + LambertW(x ))(a x+LambertW(x )) x
--

--S 28 of 28 used to work
integrate(f,x)
--R
--E 28
--   
--        +-              -+
--        | 1           2  |
--  2 tan | - LambertW(x ) |
--        | 2              |
--        +-              -+                          2
--  --------------------------- + log(a x + LambertW(x ))
--                            2
--          +-              -+
--          | 1           2  |
--  1 + tan | - LambertW(x ) |
--          | 2              |
--          +-              -+
--
--
)spool 
)lisp (bye)
 
@
\eject
\begin{thebibliography}{99}
\bibitem{1} nothing
\end{thebibliography}
\end{document}

 
