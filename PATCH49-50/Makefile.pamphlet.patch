--- /root/axiom/Makefile.pamphlet	2006-08-29 13:01:36.000000000 -0400
+++ axiom/Makefile.pamphlet	2006-08-05 08:41:49.000000000 -0400
@@ -277,21 +277,21 @@
 SUBPART= everything
 
 @
-\subsubsection{DESTDIR and COMMAND}
+\subsubsection{INSTALL and COMMAND}
 The install directory is [[/usr/local/axiom]] by default 
 but this can be changed on the command line by typing:
 \begin{verbatim}
-make DESTDIR=/yourabsolutepath COMMAND=fullPathAndCommand install
+make INSTALL=/yourabsolutepath COMMAND=fullPathAndCommand install
 \end{verbatim}
 
-The [[COMMAND]] string has been modified to use the [[DESTDIR]]
+The [[COMMAND]] string has been modified to use the [[INSTALL]]
 variable so we can properly find the axiom command.
 
 The [[DOCUMENT]] variable is now set to replace the direct call
 to the [[$SPADBIN/document]] command. This will allow it to be
 changed on the command line.
 <<environment>>=
-VERSION="Axiom (September 2006)"
+VERSION="Axiom (build improvements branch) -- 2006-08-21"
 SPD=$(shell pwd)
 SYS=$(notdir $(AXIOM))
 SPAD=${SPD}/mnt/${SYS}
@@ -308,8 +308,8 @@
 SPADBIN=${MNT}/${SYS}/bin
 INC=${SPD}/src/include
 CCLBASE=${OBJ}/${SYS}/ccl/ccllisp
-DESTDIR=/usr/local/axiom
-COMMAND=${DESTDIR}/mnt/${SYS}/bin/axiom
+INSTALL=/usr/local/axiom
+COMMAND=${INSTALL}/mnt/${SYS}/bin/axiom
 DOCUMENT=${SPADBIN}/document
 TANGLE=${SPADBIN}/lib/notangle
 WEAVE=${SPADBIN}/lib/noweave
@@ -345,7 +345,6 @@
 	@mkdir -p ${TMP}
 	@mkdir -p ${MNT}/${SYS}/bin/lib
 	@mkdir -p ${MNT}/${SYS}/doc/src
-	@cp -pr ${SRC}/scripts/* ${MNT}/${SYS}/bin
 
 @
 
@@ -588,11 +587,11 @@
 \subsection{install}
 <<install>>=
 install:
-	@echo 78 installing Axiom in ${DESTDIR}
-	@mkdir -p ${DESTDIR}
-	@cp -pr ${MNT} ${DESTDIR}
+	@echo 78 installing Axiom in ${INSTALL}
+	@mkdir -p ${INSTALL}
+	@cp -pr ${MNT} ${INSTALL}
 	@echo '#!/bin/sh -' >${COMMAND}
-	@echo AXIOM=${DESTDIR}/mnt/${SYS} >>${COMMAND}
+	@echo AXIOM=${INSTALL}/mnt/${SYS} >>${COMMAND}
 	@echo export AXIOM >>${COMMAND}
 	@echo PATH='$${AXIOM}/bin':'$${PATH}' >>${COMMAND}
 	@echo export PATH >>${COMMAND}
@@ -701,13 +700,6 @@
 \subsubsection{The [[BYE]] variable }
 
 \subsubsection{The [[LISP]] variable }
-There are 3 kinds of "lisp" files in the Axiom build process.
-The first are the "clisp" files. These are common lisp files
-generated by the boot compiler. The second are the "lisp" files.
-These are hand written common lisp code. The third are the "lsp"
-files. These are files generated by GNU Common Lisp. The LISP
-variable is used to name the third kind of files as this may
-change when the underlying common lisp is changed.
 
 \subsubsection{The [[DAASE]] variable}
 Axiom uses 5 files, the *.daase files, which are called ``the
@@ -776,8 +768,7 @@
 #GCLVERSION=gcl-2.6.6
 #GCLVERSION=gcl-2.6.7pre
 #GCLVERSION=gcl-2.6.7
-#GCLVERSION=gcl-2.6.8pre
-GCLVERSION=gcl-2.6.8pre2
+GCLVERSION=gcl-2.6.8pre
 @
 
 \subsubsection{The [[GCLOPTS]] configure variable}
@@ -785,21 +776,14 @@
 for building which vary from system
 to system. We create an environment variable here so we can add options
 to the configure command in the [[lsp/Makefile.pamphlet]].
-
 <<GCLOPTS>>=
 GCLOPTS="--enable-vssize=65536*2 --enable-statsysbfd --enable-maxpage=256*1024"
 @
 It turns out that we can successfully build GCL on many more systems
 if we set the [[GCLOPTS]] to build a local [[BFD]].
-
-We are failing during build because "directoryp is undefined" along
-with the message
-\begin{verbatim}
-Error: Cannot get relocated section contents
-\end{verbatim}
 <<GCLOPTS-LOCBFD>>=
 GCLOPTS="--enable-vssize=65536*2 --enable-locbfd --disable-dynsysbfd \
-         --disable-statsysbfd --enable-maxpage=256*1024 --disable-xgcl"
+         --disable-statsysbfd --enable-maxpage=256*1024"
 @
 For the MACOSX port we need the following options
 <<GCLOPTS-CUSTRELOC>>=
@@ -1238,16 +1222,6 @@
 depend on the default extension behavior because the system build
 will load either the interpreted or compiled form of a file depending
 on which is available. This varies at different stages of the build.
-
-It turns out that the standard GCL OPTS does not compile with the
-GCL 2.6.8pre version. We changed it from 
-\begin{verbatim}
-@<<GCLOPTS>>
-\end{verbatim}
-to read
-\begin{verbatim}
-@<<GCLOPTS-LOCBFD>>
-\end{verbatim}
 <<Makefile.linux>>=
 # System dependent Makefile for the Intel/Linux platform
 # Platform variable
@@ -1255,82 +1229,7 @@
 # C compiler flags
 CCF="-O2 -fno-strength-reduce -Wall -D_GNU_SOURCE -D${PLF} -I/usr/X11/include"
 # Loader flags
-LDF=" -L/usr/X11R6/lib ${XLIB}/libXpm.a "
-# C compiler to use
-CC=gcc 
-AWK=gawk
-RANLIB=ranlib
-TOUCH=touch
-TAR=tar
-AXIOMXLROOT=${AXIOM}/compiler
-O=o
-BYE=bye
-LISP=lsp
-DAASE=${SRC}/share
-# where the libXpm.a library lives
-XLIB=/usr/X11R6/lib
-<<GCLOPTS-LOCBFD>>
-<<SRCDIRS>>
-PATCH=patch
-
-ENV=PLF=${PLF} CCF=${CCF} LDF=${LDF} CC=${CC} AWK=${AWK} RANLIB=${RANLIB} \
-    TOUCH=${TOUCH} TAR=${TAR} AXIOMXLROOT=${AXIOMXLROOT} O=${O} BYE=${BYE} \
-    LISP=${LISP} DAASE=${DAASE} XLIB=${XLIB} GCLOPTS=${GCLOPTS} \
-    SRCDIRS=${SRCDIRS} PATCH=${PATCH}
-
-all: rootdirs noweb srcsetup lspdir srcdir
-	@echo 45 Makefile.linux called
-	@echo 46 Environment : ${ENV} 
-	@echo 47 finished system build on `date` | tee >lastBuildDate
-
-<<rootdirs>>
-<<noweb>>
-<<literate commands>>
-<<srcsetup>>
-<<src>>
-<<lsp>>
-<<document>>
-<<clean>>
-
-@
-\subsection{Makefile.fedora5}
-On Fedora Core 5 we cannot use the line
-\begin{verbatim}
-  ${XLIB}/libXpm.a
-\end{verbatim}
-to link to the Xpm libraries. Instead We need to use
-\begin{verbatim}
-  -l Xpm
-\end{verbatim}
-These are added onto the end of the LDF variable.
-
-Annoyingly enough it seems that GCL uses a default extension of .lsp
-rather than .lisp so we add the [[LISP]] variable here. We need to
-depend on the default extension behavior because the system build
-will load either the interpreted or compiled form of a file depending
-on which is available. This varies at different stages of the build.
-
-It turns out that the standard GCL OPTS does not compile with the
-GCL 2.6.8pre version. We changed it from 
-\begin{verbatim}
-@<<GCLOPTS>>
-\end{verbatim}
-to read
-\begin{verbatim}
-@<<GCLOPTS-LOCBFD>>
-\end{verbatim}
-
-GCL-2.6.8pre2 will not build successfully on fedora core 5
-so we need to downgrade the GCLVERSION.
-<<Makefile.fedora5>>=
-GCLVERSION=gcl-2.6.8pre
-# System dependent Makefile for the Intel/Linux platform
-# Platform variable
-PLF=LINUXplatform
-# C compiler flags
-CCF="-O2 -fno-strength-reduce -Wall -D_GNU_SOURCE -D${PLF} -I/usr/X11/include"
-# Loader flags
-LDF=" -L/usr/X11R6/lib -l Xpm "
+LDF= -L/usr/X11R6/lib 
 # C compiler to use
 CC=gcc 
 AWK=gawk
@@ -1344,7 +1243,7 @@
 DAASE=${SRC}/share
 # where the libXpm.a library lives
 XLIB=/usr/X11R6/lib
-<<GCLOPTS-LOCBFD>>
+<<GCLOPTS>>
 <<SRCDIRS>>
 PATCH=patch
 
